(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[22],{461:function(e,t,s){"use strict";var a=s(475),r=s.n(a),c=s(32),n=s(476).a(),o=s(29),l=s(265);const i=r.a.create({baseURL:c.a,timeout:6e4}),d="/auth/login";i.interceptors.request.use((e=>{const t=localStorage.getItem(o.b);return t&&(e.headers.authorization=t),t||e.headers["public-request"]||(n.push(d),window.location.reload()),e}),(e=>{l.a.error({message:"Error"}),Promise.reject(e)})),i.interceptors.response.use((e=>e.data),(e=>{let t={message:""};return e.response&&(400!==e.response.status&&403!==e.response.status&&401!==e.response.status||(t.message="Authentication Fail",t.description="Please login again",localStorage.removeItem(o.b),n.push(d),window.location.reload()),404===e.response.status&&(t.message="Not Found"),500===e.response.status&&(t.message="Internal Server Error"),508===e.response.status&&(t.message="Time Out"),l.a.error(t)),Promise.reject(e)}));t.a=i},462:function(e,t,s){"use strict";var a=s(461);const r={getByID:function(e){return a.a.get("/classes/".concat(e))},getAll:function(e){return a.a.get("/classes",{params:e})},delete:function(e){return a.a.delete("/classes/".concat(e))},update:function(e,t){return a.a.post("/classes/".concat(e),t)},create:function(e){return a.a.post("/classes",e)},copy:function(e){return a.a.post("/classes/".concat(e,"/copy"))},import:function(e){const t=new FormData;return t.append("attachment",e),a.a.post("/classes/import",t,{headers:{"Content-Type":"multipart/form-data"}})},exportAll:function(e){if("xlsx"!==e&&"csv"!==e)throw new Error("File type must be either xlsx or csv");return a.a.get("/classes/export?type=".concat(e),{responseType:"blob"})},export:function(e,t){if("xlsx"!==t&&"csv"!==t)throw new Error("File type must be either xlsx or csv");return a.a.post("/classes/export/".concat(t),{ids:e})}};t.a=r},478:function(e,t,s){"use strict";s(0);var a=s(429),r=s(1);const c=e=>Object(r.jsx)(a.a,{...e,className:"ant-avatar-".concat(e.type),children:e.text});t.a=e=>{const{name:t,suffix:s,subTitle:a,id:n,type:o,src:l,icon:i,size:d,shape:p,gap:u,text:x,onNameClick:b}=e;return Object(r.jsxs)("div",{className:"avatar-status d-flex align-items-center",children:[c({icon:i,src:l,type:o,size:d,shape:p,gap:u,text:x}),Object(r.jsxs)("div",{className:"ml-2",children:[Object(r.jsxs)("div",{children:[b?Object(r.jsx)("div",{onClick:()=>b({name:t,subTitle:a,src:l,id:n}),className:"avatar-status-name clickable",children:t}):Object(r.jsx)("div",{className:"avatar-status-name",children:t}),Object(r.jsx)("span",{children:s})]}),Object(r.jsx)("div",{className:"text-muted avatar-status-subtitle",children:a})]})]})}},614:function(e,t,s){"use strict";s.r(t);var a=s(0),r=s(79),c=s(264),n=s(636),o=s(110),l=s(633),i=s(462),d=s(478),p=s(116),u=s(51),x=s(1);const{Option:b}=r.a;t.default=()=>{const[e,t]=Object(a.useState)([]),[s,m]=Object(a.useState)([]),[h,j]=Object(a.useState)(!1),[f,g]=Object(a.useState)("xlsx"),[O,y]=Object(a.useState)([]),[v,w]=Object(a.useState)([]);Object(a.useEffect)((()=>{(async()=>{try{j(!0);const e=await i.a.getAll();t(e.data||[])}catch(e){console.error("Error fetching classes:",e),c.b.error("Failed to load classes"),t([])}finally{j(!1)}})()}),[]),Object(a.useEffect)((()=>{m(e)}),[e]);const S=[{title:"ID",dataIndex:"id"},{title:"Class Name",dataIndex:"name",render:(e,t)=>Object(x.jsx)("div",{className:"d-flex",children:Object(x.jsx)(d.a,{size:60,type:"square",src:"/img/thumbs/book.webp",name:t.name})}),sorter:(e,t)=>u.a.antdTableSorter(e,t,"name")},{title:"Code",dataIndex:"code",sorter:(e,t)=>u.a.antdTableSorter(e,t,"code")},{title:"Description",dataIndex:"description",sorter:(e,t)=>u.a.antdTableSorter(e,t,"description")}],E={onChange:(e,t)=>{w(e),y(t)}};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"mb-3",children:Object(x.jsx)(n.a,{children:Object(x.jsxs)(p.a,{alignItems:"center",justifyContent:"space-between",children:[Object(x.jsx)("h3",{className:"mb-0 mr-5",children:"Export Classes"}),Object(x.jsxs)(p.a,{justifyContent:"flex-start",children:[Object(x.jsxs)(r.a,{defaultValue:"xlsx",style:{width:200},value:f,onChange:e=>{g(e)},placeholder:"Select file type",children:[Object(x.jsx)(b,{value:"xlsx",children:"Excel (.xlsx)"}),Object(x.jsx)(b,{value:"csv",children:"CSV (.csv)"})]}),Object(x.jsx)(o.a,{onClick:()=>{if(!f)return void c.b.error("Please select a file type");const e=O.length>0?O:s;if(0===e.length)return void c.b.warning("No data to export");if(0===O.length){return void(async()=>{try{j(!0);const e=await i.a.exportAll(f);if(console.log("Exported all classes:",e),e)if(c.b.success("All classes exported successfully as ".concat(f.toUpperCase())),e.url)window.open(e.url,"_blank");else{const t="xlsx"===f?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv";let s;s=e instanceof Blob?e:e.data?new Blob([e.data],{type:t}):new Blob([e],{type:t});const a=window.URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download="all_classes_export_".concat((new Date).toISOString().split("T")[0],".").concat(f),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(a),r.remove()}}catch(e){console.error("Error exporting all classes:",e),c.b.error("Failed to export all classes: ".concat(e.message||"Unknown error"))}finally{j(!1)}})()}j(!0);(async()=>{try{const t={ids:e.map((e=>e.id))};console.log("Exporting with file type: ".concat(f,", params:"),t);const s=t.ids.join(","),a=new URLSearchParams;a.append("ids",s),a.append("type",f);const r="".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_BASE_URL||"","/api/classes/export?").concat(a.toString());window.open(r,"_blank"),c.b.success("Classes exported successfully as ".concat(f.toUpperCase())),j(!1)}catch(t){console.error("Error exporting classes:",t),c.b.error("Failed to export classes: ".concat(t.message||"Unknown error"))}finally{j(!1)}})()},type:"primary",loading:h,style:{marginLeft:16},disabled:0===s.length,children:O.length>0?"Export Selected (".concat(O.length,")"):"Export All"})]})]})})}),Object(x.jsx)(n.a,{children:Object(x.jsx)("div",{className:"table-responsive",children:Object(x.jsx)(l.a,{columns:S,dataSource:Array.isArray(s)?s:[],rowKey:"id",loading:h,rowSelection:{selectedRowKeys:v,type:"checkbox",...E}})})})]})}}}]);
//# sourceMappingURL=22.6ade80c7.chunk.js.map